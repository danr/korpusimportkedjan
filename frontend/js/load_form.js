// Generated by CoffeeScript 1.4.0
(function() {
  var set_form,
    __slice = [].slice;

  window.with_form = {
    get: function() {
      return console.log("Error: Form not loaded!");
    },
    set: function() {
      return console.log("Error: Form not loaded!");
    },
    load_defaults: function() {
      return console.log("Error: Form not loaded!");
    }
  };

  set_form = function(schema, value) {
    var form;
    form = json_schema_form.generate(schema, "settings");
    $("#form").empty().append(form.dom);
    form.set(value);
    window.with_form.set = form.set;
    window.with_form.load_defaults = function() {
      return form.set(value);
    };
    return window.with_form.get = form.get;
  };

  window.load_form = function(xml_editor) {
    return $.ajax({
      url: config.address + "/schema",
      dataType: "json",
      timeout: 300000,
      type: "GET",
      success: function(data, textStatus, xhr) {
        var defaults, schema;
        schema = json_schema_utils.flatten_singleton_unions(json_schema_utils.follow_references(data));
        defaults = json_schema_utils.get_default(schema);
        set_form(schema, defaults);
        return address.try_join_with_hash(xml_editor);
      },
      error: function() {
        var info;
        info = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        return console.log(info);
      }
    });
  };

}).call(this);
